<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Timetable | Student Companion</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* ===== CSS VARIABLES ===== */
    :root {
      --primary-color: #7b61ff;
      --primary-dark: #6749ff;
      --primary-light: #9d8aff;
      --secondary-color: #00ffcc;
      --accent-color: #ff00ff;
      --background-dark: #0f0f2f;
      --background-darker: #06060a;
      --card-bg: rgba(30, 30, 46, 0.9);
      --card-bg-solid: #1a1a2e;
      --text-light: #ffffff;
      --text-muted: #bbbbbb;
      --text-gray: #888888;
      --border-color: rgba(123, 97, 255, 0.3);
      --shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
      --transition: all 0.3s ease;
      --gradient: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    }

    /* ===== GLOBAL RESET & BASE STYLES ===== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background: linear-gradient(135deg, var(--background-darker), var(--background-dark));
      color: var(--text-light);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      line-height: 1.6;
      position: relative;
    }

    /* ===== NAVBAR ===== */
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
      background: rgba(15, 15, 47, 0.9);
      backdrop-filter: blur(15px);
      border-bottom: 1px solid var(--border-color);
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      height: 70px;
    }

    .navbar .brand {
      font-size: 1.6rem;
      font-weight: 700;
      color: var(--secondary-color);
      display: flex;
      align-items: center;
      gap: 0.8rem;
    }

    .brand-icon {
      font-size: 1.8rem;
      filter: drop-shadow(0 0 5px rgba(0, 255, 204, 0.5));
    }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .back-icon {
      fill: var(--secondary-color);
      transition: var(--transition);
    }

    .back-icon:hover {
      fill: var(--primary-color);
      transform: scale(1.1);
    }

    /* ===== MAIN CONTENT ===== */
    .container {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
      margin-top: 70px;
      width: 100%;
      max-width: 1200px;
      margin-left: auto;
      margin-right: auto;
    }

    .timetable-container {
      background: var(--card-bg);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      padding: 2.2rem;
      box-shadow: var(--shadow);
      border: 1px solid var(--border-color);
      width: 100%;
      animation: fadeIn 0.8s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 0.5rem;
      background: linear-gradient(90deg, var(--secondary-color), var(--primary-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      text-align: center;
    }

    .subtitle {
      color: var(--text-muted);
      font-size: 1.1rem;
      text-align: center;
      margin-bottom: 2rem;
    }

    /* ===== TIMETABLE FORM ===== */
    .timetable-form {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
      padding: 1.5rem;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      border: 1px solid var(--border-color);
    }

    .form-buttons {
      grid-column: 1 / -1;
      display: flex;
      gap: 1rem;
      justify-content: center;
    }

    input, select {
      width: 100%;
      padding: 1rem 1.2rem;
      background: rgba(255, 255, 255, 0.08);
      border: 1.5px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      color:#06060a;
      font-size: 1rem;
      transition: var(--transition);
    }

    input:focus, select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(123, 97, 255, 0.2);
      background: rgba(255, 255, 255, 0.12);
    }

    input::placeholder {
      color: var(--text-gray);
    }

    /* ===== BUTTONS ===== */
    .btn-primary, .btn-secondary {
      padding: 1rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      justify-content: center;
    }

    .btn-primary {
      background: var(--gradient);
      color: white;
      box-shadow: 0 5px 15px rgba(123, 97, 255, 0.4);
    }

    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 25px rgba(123, 97, 255, 0.5);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-light);
      border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    /* ===== TIMETABLE LIST ===== */
    .timetable-list {
      list-style: none;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .timetable-item {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      padding: 1.5rem;
      border: 1px solid var(--border-color);
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }

    .timetable-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(123, 97, 255, 0.3);
      border-color: var(--primary-color);
    }

    .timetable-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: var(--gradient);
    }

    .class-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1rem;
    }

    .class-name {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--text-light);
      margin-bottom: 0.5rem;
    }

    .class-day {
      background: var(--primary-color);
      color: white;
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .class-time {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--secondary-color);
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .notification-info {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--text-muted);
      font-size: 0.9rem;
      margin-bottom: 1rem;
    }

    .class-actions {
      display: flex;
      gap: 0.5rem;
      justify-content: flex-end;
    }

    .edit-btn, .delete-btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 8px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }

    .edit-btn {
      background: rgba(0, 255, 204, 0.1);
      color: var(--secondary-color);
      border: 1px solid rgba(0, 255, 204, 0.3);
    }

    .edit-btn:hover {
      background: rgba(0, 255, 204, 0.2);
    }

    .delete-btn {
      background: rgba(255, 0, 0, 0.1);
      color: #ff6b6b;
      border: 1px solid rgba(255, 0, 0, 0.3);
    }

    .delete-btn:hover {
      background: rgba(255, 0, 0, 0.2);
    }

    /* ===== FLOATING AI ===== */
    .floating-ai {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      padding: 12px 18px;
      border-radius: 30px;
      color: #fff;
      font-weight: 600;
      font-size: 14px;
      text-decoration: none;
      box-shadow: 0 0 12px rgba(123, 97, 255, 0.7);
      transition: 0.3s ease;
      z-index: 999;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .floating-ai:hover {
      transform: scale(1.07);
      box-shadow: 0 0 20px rgba(123, 97, 255, 0.9);
    }

    /* ===== EMPTY STATE ===== */
    .empty-state {
      text-align: center;
      padding: 3rem;
      color: var(--text-muted);
    }

    .empty-state i {
      font-size: 3rem;
      margin-bottom: 1rem;
      opacity: 0.5;
    }

    /* ===== RESPONSIVE DESIGN ===== */
    @media (max-width: 768px) {
      .navbar {
        padding: 1rem;
      }
      
      .container {
        padding: 1rem;
      }
      
      .timetable-container {
        padding: 1.5rem;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .timetable-form {
        grid-template-columns: 1fr;
      }
      
      .timetable-list {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      .navbar .brand {
        font-size: 1.3rem;
      }
      
      .timetable-container {
        padding: 1.2rem;
      }
      
      .form-buttons {
        flex-direction: column;
      }
      
      .class-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
      }
    }
    
    .notification-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10000;
}

.notification {
    background: #333;
    color: white;
    padding: 15px 20px;
    margin-bottom: 10px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    min-width: 300px;
    max-width: 400px;
    animation: slideIn 0.3s ease-out;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-left: 4px solid #2196F3;
}

.notification.success { 
    background: #4CAF50; 
    border-left-color: #45a049;
}
.notification.error { 
    background: #f44336; 
    border-left-color: #da190b;
}
.notification.warning { 
    background: #ff9800; 
    border-left-color: #e68900;
}
.notification.info { 
    background: #2196F3; 
    border-left-color: #0b7dda;
}

.notification-close {
    background: none;
    border: none;
    color: white;
    font-size: 18px;
    cursor: pointer;
    margin-left: 10px;
    padding: 0;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
}

.notification-close:hover {
    background: rgba(255,255,255,0.2);
}

@keyframes slideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

.notification.fade-out {
    animation: slideOut 0.3s ease-in forwards;
}

@keyframes slideOut {
    from {
        transform: translateX(0);
        opacity: 1;
    }
    to {
        transform: translateX(100%);
        opacity: 0;
    }
}

  </style>
  <meta name="theme-color" content="#7b61ff">
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="brand">
      <i class="fas fa-graduation-cap brand-icon"></i>
      Student Companion
    </div>
    <div class="nav-right">
      <a href="homepage.html" aria-label="Back to homepage">
        <svg class="back-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false" width="34" height="34">
          <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
        </svg>
      </a>
    </div>
  </nav>

  <!-- Timetable Section -->
  <main class="container fade-in timetable-container">
    <h1>üìÖ My Timetable</h1>
    <p class="subtitle">Add, view, and manage your daily classes.</p>

    <form id="timetableForm" class="timetable-form">
      <input id="classCourse" type="text" placeholder="Course name (e.g. Physics 101)" required>
      
      <select id="classDay" required>
        <option value="">Select Day</option>
        <option value="Monday">Monday</option>
        <option value="Tuesday">Tuesday</option>
        <option value="Wednesday">Wednesday</option>
        <option value="Thursday">Thursday</option>
        <option value="Friday">Friday</option>
        <option value="Saturday">Saturday</option>
        <option value="Sunday">Sunday</option>
      </select>

      <input id="classTime" type="time" required>

      <select id="notifyBefore">
        <option value="5">Notify 5 minutes before</option>
        <option value="10">Notify 10 minutes before</option>
        <option value="20">Notify 20 minutes before</option>
        <option value="30">Notify 30 minutes before</option>
      </select>
  
      <div class="form-buttons">
        <button type="submit" id="addClassBtn" class="btn-primary">
          <i class="fas fa-plus"></i> Add Class
        </button>
        <button type="button" id="cancelEditBtn" class="btn-secondary" style="display:none;">
          <i class="fas fa-times"></i> Cancel Edit
        </button>
      </div>
    </form>
    
    <h2 style="margin: 2rem 0 1rem 0; text-align: center; color: var(--text-light);">
      <u>Your Classes</u>
    </h2>
    
    <ul id="timetableList" class="timetable-list">
      <!-- Classes will be dynamically added here -->
    </ul>
  </main>
   
  <a href="ai.html" class="floating-ai">
    <i class="fas fa-robot"></i> AI Assistant
  </a>

  <script>
    // ====== USER & LOGOUT ======
    function getCurrentUser() { 
      return localStorage.getItem("currentUser") || localStorage.getItem("loginUser"); 
    }
    
    const user = getCurrentUser();
    if(!user) { 
      alert("Please log in!"); 
      window.location.href = "index.html"; 
    }
    
    // Initialize user data structure
    let users = JSON.parse(localStorage.getItem("users")) || {};
    if(!users[user]) {
      users[user] = { 
        password: "", 
        notes: [], 
        timetable: [], 
        gpa: [], 
        profile: {}, 
        notifications: [] 
      };
    }
    localStorage.setItem("users", JSON.stringify(users));
    users = JSON.parse(localStorage.getItem("users")); // reload

    // ====== TIMETABLE FUNCTIONALITY ======
    const timetableForm = document.getElementById('timetableForm');
    const timetableList = document.getElementById('timetableList');
    const cancelEditBtn = document.getElementById('cancelEditBtn');
    
    let editingIndex = -1;
    
    // Load timetable on page load
    document.addEventListener('DOMContentLoaded', () => {
      loadTimetable();
    });
    
    // Form submission handler
// Form submission handler
timetableForm.addEventListener('submit', (e) => {
    e.preventDefault();
    
    const course = document.getElementById('classCourse').value;
    const day = document.getElementById('classDay').value;
    const time = document.getElementById('classTime').value;
    const notifyBefore = document.getElementById('notifyBefore').value;
    
    if (editingIndex === -1) {
        // Add new class
        users[user].timetable.push({
            course,
            day,
            time,
            notifyBefore
        });
        showNotification(`‚úÖ Added ${course} to timetable`, 'success');
    } else {
        // Update existing class
        users[user].timetable[editingIndex] = {
            course,
            day,
            time,
            notifyBefore
        };
        
        // Reset editing state
        editingIndex = -1;
        cancelEditBtn.style.display = 'none';
        document.getElementById('addClassBtn').innerHTML = '<i class="fas fa-plus"></i> Add Class';
        showNotification(`‚úèÔ∏è Updated ${course}`, 'info');
    }
    
    // Save to localStorage
    localStorage.setItem('users', JSON.stringify(users));
    
    // Reset form
    timetableForm.reset();
    
    // Reload timetable
    loadTimetable();
});

// Delete class function
window.deleteClass = function(index) {
    const classItem = users[user].timetable[index];
    if (confirm('Are you sure you want to delete this class?')) {
        users[user].timetable.splice(index, 1);
        localStorage.setItem('users', JSON.stringify(users));
        loadTimetable();
        showNotification(`üóëÔ∏è Deleted ${classItem.course} from timetable`, 'warning');
    }
}

    // Load timetable from localStorage
    function loadTimetable() {
      timetableList.innerHTML = '';
      
      if (users[user].timetable.length === 0) {
        timetableList.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-calendar-plus"></i>
            <h3>No classes added yet</h3>
            <p>Add your first class using the form above</p>
          </div>
        `;
        return;
      }
      
      users[user].timetable.forEach((classItem, index) => {
        const li = document.createElement('li');
        li.className = 'timetable-item';
        
        // Format time for display
        const timeParts = classItem.time.split(':');
        let hours = parseInt(timeParts[0]);
        let minutes = timeParts[1];
        const ampm = hours >= 12 ? 'PM' : 'AM';
        hours = hours % 12 || 12;
        
        li.innerHTML = `
          <div class="class-header">
            <div>
              <div class="class-name">${classItem.course}</div>
              <div class="class-day">${classItem.day}</div>
            </div>
          </div>
          <div class="class-time">
            <i class="fas fa-clock"></i>
            <span>${hours}:${minutes} ${ampm}</span>
          </div>
          <div class="notification-info">
            <i class="fas fa-bell"></i>
            <span>Notify ${classItem.notifyBefore} minutes before</span>
          </div>
          <div class="class-actions">
            <button class="edit-btn" onclick="editClass(${index})">
              <i class="fas fa-edit"></i> Edit
            </button>
            <button class="delete-btn" onclick="deleteClass(${index})">
              <i class="fas fa-trash"></i> Delete
            </button>
          </div>
        `;
        
        timetableList.appendChild(li);
      });
    }
    
    // Edit class function
    window.editClass = function(index) {
      const classItem = users[user].timetable[index];
      
      document.getElementById('classCourse').value = classItem.course;
      document.getElementById('classDay').value = classItem.day;
      document.getElementById('classTime').value = classItem.time;
      document.getElementById('notifyBefore').value = classItem.notifyBefore;
      
      editingIndex = index;
      cancelEditBtn.style.display = 'inline-block';
      document.getElementById('addClassBtn').innerHTML = '<i class="fas fa-save"></i> Update Class';
      
      // Scroll to form
      timetableForm.scrollIntoView({ behavior: 'smooth' });
    }
    
    // Delete class function
    window.deleteClass = function(index) {
      if (confirm('Are you sure you want to delete this class?')) {
        users[user].timetable.splice(index, 1);
        localStorage.setItem('users', JSON.stringify(users));
        loadTimetable();
      }
    }

    // Notification system
function showNotification(message, type = 'info', duration = 5000) {
    const container = document.getElementById('notificationContainer');
    if (!container) return;
    
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    
    notification.innerHTML = `
        <div class="notification-content">
            <span>${message}</span>
        </div>
        <button class="notification-close">&times;</button>
    `;
    
    container.appendChild(notification);
    
    // Close button event
    const closeBtn = notification.querySelector('.notification-close');
    closeBtn.addEventListener('click', () => {
        removeNotification(notification);
    });
    
    // Auto remove after duration
    if (duration > 0) {
        setTimeout(() => {
            removeNotification(notification);
        }, duration);
    }
    
    return notification;
}

function removeNotification(notification) {
    notification.classList.add('fade-out');
    setTimeout(() => {
        if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
        }
    }, 300);
}

// Class reminder system
function checkClassReminders() {
    const now = new Date();
    const currentDay = now.toLocaleString('en-us', { weekday: 'long' });
    const currentTime = now.getHours() * 60 + now.getMinutes();
    
    const userTimetable = users[user].timetable;
    
    userTimetable.forEach((classItem) => {
        // Check if class is today
        if (classItem.day.toLowerCase() === currentDay.toLowerCase()) {
            const [classHours, classMinutes] = classItem.time.split(':').map(Number);
            const classStartTime = classHours * 60 + classMinutes;
            const notifyBefore = parseInt(classItem.notifyBefore) || 0;
            
            const reminderTime = classStartTime - notifyBefore;
            
            // Check if it's time to show reminder
            if (currentTime >= reminderTime && currentTime < reminderTime + 1) {
                showNotification(
                    `üîî ${classItem.course} starts in ${notifyBefore} minutes!`,
                    'info',
                    10000
                );
            }
            
            // Check if class is starting now
            if (currentTime >= classStartTime && currentTime < classStartTime + 1) {
                showNotification(
                    `‚è∞ ${classItem.course} is starting now!`,
                    'warning',
                    10000
                );
            }
        }
    });
}

// Check for reminders every minute
setInterval(checkClassReminders, 60000);

// Check immediately when page loads
setTimeout(checkClassReminders, 2000);

  </script>
</body>
</html>