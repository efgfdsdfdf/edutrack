<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Home | Student Companion</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --mature-bg: linear-gradient(180deg,#06060a,#0b0b10);
      --mature-surface: rgba(255,255,255,0.03);
      --mature-card: #0f1114;
      --mature-accent: #7b61ff;
      --mature-accent-2: #6248e6;
      --muted-text: #c7cbd6;
      --muted-weak: #98a0b3;
      --border-soft: rgba(255,255,255,0.04);
      --success: #00ff9d;
      --info: #00b8ff;
      --warning: #ffb800;
    }

    /* ---------- GLOBAL ---------- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    body {
      background: var(--mature-bg) !important;
      color: var(--muted-text);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      padding-bottom: 70px; /* Space for bottom nav */
    }

    /* ---------- ANIMATIONS ---------- */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    /* ---------- BOTTOM NAVIGATION ---------- */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(15, 17, 20, 0.95);
      backdrop-filter: blur(20px);
      border-top: 1px solid var(--border-soft);
      display: flex;
      justify-content: space-around;
      padding: 12px 0;
      z-index: 1000;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-decoration: none;
      color: var(--muted-weak);
      font-size: 0.75rem;
      transition: all 0.3s ease;
      padding: 8px 16px;
      border-radius: 12px;
      min-width: 70px;
    }

    .nav-item i {
      font-size: 1.2rem;
      margin-bottom: 4px;
      transition: all 0.3s ease;
    }

    .nav-item.active {
      color: var(--mature-accent);
      background: rgba(123, 97, 255, 0.1);
    }

    .nav-item.active i {
      transform: translateY(-2px);
    }

    .nav-item:hover {
      color: var(--mature-accent);
      transform: translateY(-2px);
    }

    /* ---------- MAIN CONTENT ---------- */
    .main-content {
      flex: 1;
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
      width: 100%;
      animation: fadeIn 0.6s ease-out;
    }

    /* ---------- HERO SECTION ---------- */
    .hero-section {
      text-align: center;
      margin: 30px 0 40px;
      padding: 20px;
    }

    .welcome-card {
      background: linear-gradient(135deg, rgba(123, 97, 255, 0.1), rgba(98, 72, 230, 0.05));
      border-radius: 24px;
      padding: 30px;
      border: 1px solid rgba(123, 97, 255, 0.2);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
      margin-bottom: 30px;
    }

    .avatar {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, var(--mature-accent), var(--mature-accent-2));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      margin: 0 auto 20px;
      color: white;
      animation: float 6s ease-in-out infinite;
    }

    .hero-title {
      font-size: 2.5rem;
      background: linear-gradient(135deg, var(--mature-accent), var(--success));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
      font-weight: 800;
    }

    .hero-subtitle {
      font-size: 1.1rem;
      color: var(--muted-weak);
      max-width: 600px;
      margin: 0 auto;
      line-height: 1.6;
    }

    /* ---------- STATS GRID ---------- */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }

    .stat-card {
      background: var(--mature-card);
      border-radius: 16px;
      padding: 24px;
      border: 1px solid var(--border-soft);
      transition: all 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      border-color: var(--mature-accent);
      box-shadow: 0 10px 30px rgba(123, 97, 255, 0.2);
    }

    .stat-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }

    .stat-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      font-size: 1.5rem;
    }

    .notes-icon { background: rgba(0, 255, 157, 0.1); color: var(--success); }
    .calendar-icon { background: rgba(0, 184, 255, 0.1); color: var(--info); }
    .gpa-icon { background: rgba(255, 184, 0, 0.1); color: var(--warning); }

    .stat-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--muted-text);
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--mature-accent), var(--success));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
    }

    .stat-progress {
      height: 6px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 3px;
      overflow: hidden;
      margin-top: 15px;
    }

    .progress-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 1s ease;
    }

    .notes-progress { background: linear-gradient(90deg, var(--success), #00cc7a); }
    .calendar-progress { background: linear-gradient(90deg, var(--info), #0099cc); }
    .gpa-progress { background: linear-gradient(90deg, var(--warning), #cc9200); }

    /* ---------- QUICK LINKS ---------- */
    .quick-links {
      margin: 40px 0;
    }

    .section-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--muted-text);
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .links-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }

    .quick-link {
      background: var(--mature-card);
      border: 1px solid var(--border-soft);
      border-radius: 12px;
      padding: 20px;
      display: flex;
      align-items: center;
      text-decoration: none;
      color: var(--muted-text);
      transition: all 0.3s ease;
    }

    .quick-link:hover {
      transform: translateY(-3px);
      border-color: var(--mature-accent);
      box-shadow: 0 10px 20px rgba(123, 97, 255, 0.1);
    }

    .link-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      font-size: 1.2rem;
      background: rgba(123, 97, 255, 0.1);
      color: var(--mature-accent);
    }

    .link-text h4 {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .link-text p {
      font-size: 0.85rem;
      color: var(--muted-weak);
    }

    /* ---------- TOOLS MODAL ---------- */
    .tools-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(6, 6, 10, 0.95);
      backdrop-filter: blur(10px);
      z-index: 2000;
      padding: 20px;
      overflow-y: auto;
    }

    .tools-modal.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    .tools-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    .tools-title {
      font-size: 1.8rem;
      background: linear-gradient(135deg, var(--mature-accent), var(--success));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 700;
    }

    .close-tools {
      background: none;
      border: none;
      color: var(--muted-weak);
      font-size: 1.5rem;
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .close-tools:hover {
      color: var(--mature-accent);
    }

    .tools-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 25px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .tool-card {
      background: linear-gradient(135deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid var(--border-soft);
      border-radius: 20px;
      padding: 30px;
      text-decoration: none;
      color: var(--muted-text);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .tool-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--mature-accent), var(--success));
      transform: translateX(-100%);
      transition: transform 0.3s ease;
    }

    .tool-card:hover::before {
      transform: translateX(0);
    }

    .tool-card:hover {
      transform: translateY(-8px);
      border-color: var(--mature-accent);
      box-shadow: 0 20px 40px rgba(123, 97, 255, 0.15);
    }

    .tool-icon {
      width: 60px;
      height: 60px;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      font-size: 1.8rem;
    }

    .notes-tool { background: linear-gradient(135deg, rgba(0,255,157,0.2), rgba(0,204,122,0.1)); color: var(--success); }
    .timetable-tool { background: linear-gradient(135deg, rgba(0,184,255,0.2), rgba(0,153,204,0.1)); color: var(--info); }
    .gpa-tool { background: linear-gradient(135deg, rgba(255,184,0,0.2), rgba(204,146,0,0.1)); color: var(--warning); }
    .novel-tool { background: linear-gradient(135deg, rgba(255,0,255,0.2), rgba(204,0,204,0.1)); color: #ff00ff; }
    .brain-tool { background: linear-gradient(135deg, rgba(255,105,180,0.2), rgba(255,20,147,0.1)); color: #ff69b4; }

    .tool-card h3 {
      font-size: 1.4rem;
      font-weight: 600;
      margin-bottom: 10px;
      color: var(--muted-text);
    }

    .tool-card p {
      color: var(--muted-weak);
      line-height: 1.6;
      font-size: 0.95rem;
    }

    /* ---------- ACTIVITY FEED ---------- */
    .activity-feed {
      background: var(--mature-card);
      border-radius: 16px;
      padding: 25px;
      border: 1px solid var(--border-soft);
      margin-top: 40px;
    }

    .activity-item {
      display: flex;
      align-items: flex-start;
      padding: 15px 0;
      border-bottom: 1px solid var(--border-soft);
    }

    .activity-item:last-child {
      border-bottom: none;
    }

    .activity-icon {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      background: rgba(123, 97, 255, 0.1);
      color: var(--mature-accent);
    }

    .activity-content h4 {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .activity-content p {
      font-size: 0.9rem;
      color: var(--muted-weak);
    }

    .activity-time {
      font-size: 0.8rem;
      color: var(--muted-weak);
      margin-top: 4px;
    }

    /* ---------- RESPONSIVE DESIGN ---------- */
    @media (max-width: 768px) {
      .hero-title {
        font-size: 2rem;
      }
      
      .hero-subtitle {
        font-size: 1rem;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .tools-grid {
        grid-template-columns: 1fr;
      }
      
      .links-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .main-content {
        padding: 15px;
      }
    }

    @media (max-width: 480px) {
      .hero-title {
        font-size: 1.8rem;
      }
      
      .welcome-card {
        padding: 20px;
      }
      
      .links-grid {
        grid-template-columns: 1fr;
      }
      
      .nav-item {
        min-width: 60px;
        padding: 8px 12px;
        font-size: 0.7rem;
      }
      
      .nav-item i {
        font-size: 1rem;
      }
    }

    /* ---------- FLOATING AI BUTTON ---------- */
    .floating-ai {
      position: fixed;
      bottom: 80px;
      right: 20px;
      background: linear-gradient(135deg, var(--mature-accent), var(--mature-accent-2));
      width: 56px;
      height: 56px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      text-decoration: none;
      box-shadow: 0 8px 25px rgba(123, 97, 255, 0.4);
      transition: all 0.3s ease;
      z-index: 999;
    }

    .floating-ai:hover {
      transform: scale(1.1) rotate(10deg);
      box-shadow: 0 12px 30px rgba(123, 97, 255, 0.6);
    }

    .floating-ai i {
      font-size: 1.5rem;
    }
  </style>

  <!-- PWA -->
  <link rel="manifest" href="../assets/pwa/manifest.json">
  <meta name="theme-color" content="#7b61ff">
</head>
<body>

  <!-- Main Content -->
  <main class="main-content">
    <h1>Student Companion</h1>
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="welcome-card">
        <div class="avatar">
          <i class="fas fa-graduation-cap"></i>
        </div>
        <h1 class="hero-title" id="welcomeMsg">Welcome back, Student! ðŸ‘‹</h1>
        <p class="hero-subtitle">
          Your all-in-one academic companion. Stay organized, track progress, and achieve your goals with powerful tools designed for students.
        </p>
      </div>
    </section>

    <!-- Stats Grid -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-icon notes-icon">
            <i class="fas fa-sticky-note"></i>
          </div>
          <div>
            <h3 class="stat-title">Notes</h3>
            <div class="stat-value" id="notesCountDisplay">0</div>
          </div>
        </div>
        <p>Total notes saved</p>
        <div class="stat-progress">
          <div id="notesProgress" class="progress-fill notes-progress" style="width: 0%"></div>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-icon calendar-icon">
            <i class="fas fa-calendar-alt"></i>
          </div>
          <div>
            <h3 class="stat-title">Classes</h3>
            <div class="stat-value" id="classCountDisplay">0</div>
          </div>
        </div>
        <p>Scheduled in timetable</p>
        <div class="stat-progress">
          <div id="classProgress" class="progress-fill calendar-progress" style="width: 0%"></div>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-header">
          <div class="stat-icon gpa-icon">
            <i class="fas fa-chart-line"></i>
          </div>
          <div>
            <h3 class="stat-title">GPA</h3>
            <div class="stat-value" id="gpaCountDisplay">0.0</div>
          </div>
        </div>
        <p>Current average</p>
        <div class="stat-progress">
          <div id="gpaProgress" class="progress-fill gpa-progress" style="width: 0%"></div>
        </div>
      </div>
    </div>

    <!-- Quick Links -->
    <section class="quick-links">
      <h2 class="section-title">
        <i class="fas fa-bolt"></i> Quick Actions
      </h2>
      <div class="links-grid">
        <a href="notes.html" class="quick-link">
          <div class="link-icon">
            <i class="fas fa-sticky-note"></i>
          </div>
          <div class="link-text">
            <h4>Quick Note</h4>
            <p>Jot down a quick thought</p>
          </div>
        </a>
        
        <a href="timetable.html" class="quick-link">
          <div class="link-icon">
            <i class="fas fa-calendar-plus"></i>
          </div>
          <div class="link-text">
            <h4>Add Class</h4>
            <p>Schedule a new class</p>
          </div>
        </a>
        
        <a href="gpa.html" class="quick-link">
          <div class="link-icon">
            <i class="fas fa-calculator"></i>
          </div>
          <div class="link-text">
            <h4>Calculate GPA</h4>
            <p>Add grades to track</p>
          </div>
        </a>
        
        <a href="ai2.html" class="quick-link">
          <div class="link-icon">
            <i class="fas fa-robot"></i>
          </div>
          <div class="link-text">
            <h4>AI Assistant</h4>
            <p>Get help with studies</p>
          </div>
        </a>
      </div>
    </section>

    <!-- Activity Feed -->
    <section class="activity-feed">
      <h2 class="section-title">
        <i class="fas fa-history"></i> Recent Activity
      </h2>
      <div id="recentActivity">
        <div class="activity-item">
          <div class="activity-icon">
            <i class="fas fa-rocket"></i>
          </div>
          <div class="activity-content">
            <h4>Welcome to Student Companion!</h4>
            <p>Get started by exploring all the available tools</p>
            <div class="activity-time">Just now</div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Tools Modal -->
  <div id="toolsModal" class="tools-modal">
    <div class="tools-header">
      <h2 class="tools-title">All Tools & Features</h2>
      <button class="close-tools">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="tools-grid">
      <a href="notes.html" class="tool-card">
        <div class="tool-icon notes-tool">
          <i class="fas fa-sticky-note"></i>
        </div>
        <h3>Smart Notes</h3>
        <p>Organize your study notes with categories, tags, and search. Never lose important information again.</p>
      </a>
      
      <a href="timetable.html" class="tool-card">
        <div class="tool-icon timetable-tool">
          <i class="fas fa-calendar-alt"></i>
        </div>
        <h3>Timetable Manager</h3>
        <p>Schedule classes, set reminders, and never miss an important lecture or deadline.</p>
      </a>
      
      <a href="gpa.html" class="tool-card">
        <div class="tool-icon gpa-tool">
          <i class="fas fa-chart-line"></i>
        </div>
        <h3>GPA Calculator</h3>
        <p>Track your academic performance, calculate semester GPA, and set grade targets.</p>
      </a>
      
      <a href="novels.html" class="tool-card">
        <div class="tool-icon novel-tool">
          <i class="fas fa-book-open"></i>
        </div>
        <h3>Novel Library</h3>
        <p>Access a collection of novels and literature to enhance your reading skills and relax.</p>
      </a>
      
      <a href="brainteaser.html" class="tool-card">
        <div class="tool-icon brain-tool">
          <i class="fas fa-brain"></i>
        </div>
        <h3>Brain Teasers</h3>
        <p>Challenge your mind with puzzles and brain games to improve problem-solving skills.</p>
      </a>
      
      <a href="ai2.html" class="tool-card">
        <div class="tool-icon">
          <i class="fas fa-robot"></i>
        </div>
        <h3>AI Assistant</h3>
        <p>Get instant help with homework, explanations, and study tips from our AI tutor.</p>
      </a>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav">
    <a href="homepage.html" class="nav-item active">
      <i class="fas fa-home"></i>
      Home
    </a>
    <a href="#" class="nav-item" id="toolsBtn">
      <i class="fas fa-tools"></i>
      Tools
    </a>
    <a href="profile.html" class="nav-item">
      <i class="fas fa-user"></i>
      Profile
    </a>
  </nav>

  <!-- Floating AI Button -->
  <a href="ai2.html" class="floating-ai">
    <i class="fas fa-robot"></i>
  </a>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Get user data
      const username = localStorage.getItem('currentUser') || localStorage.getItem('loginUser') || 'Student';
      document.getElementById('welcomeMsg').textContent = `Welcome back, ${username}! ðŸ‘‹`;

      // Get user data from storage
      const users = JSON.parse(localStorage.getItem('users') || '{}');
      const userData = users[username] || {};

      // Extract data with fallbacks
      const notes = Array.isArray(userData.notes) ? userData.notes : JSON.parse(localStorage.getItem('notes') || '[]');
      const timetable = Array.isArray(userData.timetable) ? userData.timetable : JSON.parse(localStorage.getItem('timetable') || '[]');
      const gpaRecords = Array.isArray(userData.gpa) ? userData.gpa : JSON.parse(localStorage.getItem('gpaRecords') || '[]');

      const notesCount = notes.length;
      const classCount = timetable.length;
      
      // Calculate GPA
      let gpaAverage = 0;
      if (gpaRecords.length > 0) {
        if (typeof gpaRecords[0] === 'number' || !gpaRecords[0].grade) {
          gpaAverage = gpaRecords.reduce((a,b) => a + Number(b || 0), 0) / gpaRecords.length;
        } else {
          const gradePoints = { A:5, B:4, C:3, D:2, E:1, F:0 };
          let totalUnits = 0, totalPoints = 0;
          gpaRecords.forEach(c => {
            const units = Number(c.units) || 0;
            const grade = (c.grade || '').toString().toUpperCase();
            const points = gradePoints[grade] !== undefined ? gradePoints[grade] : Number(c.grade) || 0;
            totalUnits += units;
            totalPoints += points * units;
          });
          gpaAverage = totalUnits > 0 ? (totalPoints / totalUnits) : 0;
        }
      }

      // Update stats with animation
      const animateCounter = (elementId, targetValue, suffix = '', isDecimal = false) => {
        const element = document.getElementById(elementId);
        if (!element) return;
        
        let current = 0;
        const increment = targetValue / 50;
        const timer = setInterval(() => {
          current += increment;
          if (current >= targetValue) {
            current = targetValue;
            clearInterval(timer);
          }
          element.textContent = isDecimal ? current.toFixed(2) + suffix : Math.floor(current) + suffix;
        }, 20);
      };

      // Animate progress bars
      const animateProgress = (elementId, percentage) => {
        const element = document.getElementById(elementId);
        if (element) {
          setTimeout(() => {
            element.style.width = `${percentage}%`;
          }, 300);
        }
      };

      // Calculate percentages (capped at 100%)
      const notesPercent = Math.min((notesCount / 50) * 100, 100);
      const classPercent = Math.min((classCount / 20) * 100, 100);
      const gpaPercent = Math.min((gpaAverage / 5) * 100, 100);

      // Start animations
      animateCounter('notesCountDisplay', notesCount);
      animateCounter('classCountDisplay', classCount);
      animateCounter('gpaCountDisplay', gpaAverage, '', true);

      setTimeout(() => {
        animateProgress('notesProgress', notesPercent);
        animateProgress('classProgress', classPercent);
        animateProgress('gpaProgress', gpaPercent);
      }, 500);

      // Update recent activity
      const recentActivity = document.getElementById('recentActivity');
      if (recentActivity) {
        const activities = [];
        
        if (notesCount > 0) {
          activities.push({
            icon: 'fa-sticky-note',
            title: 'Notes Updated',
            text: `You have ${notesCount} note${notesCount !== 1 ? 's' : ''} in your collection`,
            time: 'Today'
          });
        }
        
        if (classCount > 0) {
          activities.push({
            icon: 'fa-calendar',
            title: 'Classes Scheduled',
            text: `${classCount} item${classCount !== 1 ? 's' : ''} in your timetable`,
            time: 'Today'
          });
        }
        
        if (gpaRecords.length > 0) {
          activities.push({
            icon: 'fa-chart-line',
            title: 'GPA Tracked',
            text: `Current GPA: ${gpaAverage.toFixed(2)}`,
            time: 'Today'
          });
        }
        
        // Add default activity if none
        if (activities.length === 0) {
          activities.push({
            icon: 'fa-rocket',
            title: 'Welcome to Student Companion!',
            text: 'Get started by exploring all the available tools',
            time: 'Just now'
          });
        }
        
        // Update activity feed
        recentActivity.innerHTML = '';
        activities.forEach(activity => {
          const activityItem = document.createElement('div');
          activityItem.className = 'activity-item';
          activityItem.innerHTML = `
            <div class="activity-icon">
              <i class="fas ${activity.icon}"></i>
            </div>
            <div class="activity-content">
              <h4>${activity.title}</h4>
              <p>${activity.text}</p>
              <div class="activity-time">${activity.time}</div>
            </div>
          `;
          recentActivity.appendChild(activityItem);
        });
      }

      // Tools modal functionality
      const toolsBtn = document.getElementById('toolsBtn');
      const toolsModal = document.getElementById('toolsModal');
      const closeTools = document.querySelector('.close-tools');

      toolsBtn.addEventListener('click', (e) => {
        e.preventDefault();
        toolsModal.classList.add('active');
        document.body.style.overflow = 'hidden';
      });

      closeTools.addEventListener('click', () => {
        toolsModal.classList.remove('active');
        document.body.style.overflow = 'auto';
      });

      // Close modal when clicking outside
      toolsModal.addEventListener('click', (e) => {
        if (e.target === toolsModal) {
          toolsModal.classList.remove('active');
          document.body.style.overflow = 'auto';
        }
      });

      // Bottom nav active state
      const navItems = document.querySelectorAll('.nav-item');
      navItems.forEach(item => {
        item.addEventListener('click', () => {
          if (item.id === 'toolsBtn') return; // Don't change active state for tools button
          navItems.forEach(nav => nav.classList.remove('active'));
          item.classList.add('active');
        });
      });

      // Notification permission
      window.requestNotificationPermission = function() {
        if(!("Notification" in window)) return alert("Browser does not support notifications.");
        Notification.requestPermission().then(permission => {
          if(permission === "granted") {
            new Notification(`Hello, ${username}!`, { 
              body: "Welcome back to Student Companion ðŸŽ“",
              icon: 'https://cdn-icons-png.flaticon.com/512/2232/2232688.png'
            });
          }
        });
      };
    });
  </script>
</body>
</html>
